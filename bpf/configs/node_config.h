#include "lib/utils.h"

/*
 cilium.v4.external.str 192.168.74.3
 cilium.v4.internal.str 10.0.0.111
 cilium.v4.nodeport.str [192.168.74.3]

 cilium.v4.internal.raw 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xff, 0xff, 0xa, 0x0, 0x0, 0x6f
 */

#define NAT46_PREFIX { .addr = { 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xff, 0xff, 0x0, 0x0, 0x0, 0x0 } }
#define CT_MAP_TCP4 cilium_ct4_global
#define CT_MAP_ANY4 cilium_ct_any4_global
#define CT_MAP_TCP6 cilium_ct6_global
#define CT_MAP_ANY6 cilium_ct_any6_global
#define CT_MAP_SIZE_TCP 524288
#define CT_MAP_SIZE_ANY 262144
#define ALLOW_ICMP_FRAG_NEEDED 1
#define CILIUM_IPV4_FRAG_MAP_MAX_ENTRIES 8192
#define CILIUM_LB_MAP_MAX_ENTRIES 65536
#define CT_CLOSE_TIMEOUT 10
#define CT_CONNECTION_LIFETIME_NONTCP 60
#define CT_CONNECTION_LIFETIME_TCP 21600
#define CT_REPORT_FLAGS 0x0007
#define CT_REPORT_INTERVAL 5
#define CT_SERVICE_LIFETIME_NONTCP 60
#define CT_SERVICE_LIFETIME_TCP 21600
#define CT_SYN_TIMEOUT 60
#define DIRECT_ROUTING_DEV_IFINDEX 2
#define DSR_ENCAP_IPIP 2
#define DSR_ENCAP_MODE 0
#define DSR_ENCAP_NONE 1
#define DSR_XLATE_BACKEND 2
#define DSR_XLATE_FRONTEND 1
#define DSR_XLATE_MODE 0
#define EGRESS_MAP cilium_egress_v4
#define EGRESS_MAP_SIZE 16384
#define ENABLE_EXTERNAL_IP 1
#define ENABLE_FIB_LOOKUP_BYPASS 1
#define ENABLE_HOSTPORT 1
#define ENABLE_HOST_SERVICES_FULL 1
#define ENABLE_HOST_SERVICES_PEER 1
#define ENABLE_HOST_SERVICES_TCP 1
#define ENABLE_HOST_SERVICES_UDP 1
#define ENABLE_IDENTITY_MARK 1
#define ENABLE_IPV4 1
#define ENABLE_IPV4_FRAGMENTS 1
#define ENABLE_LOADBALANCER 1
#define ENABLE_NODEPORT 1
#define ENABLE_NODEPORT_HAIRPIN 1
#define ENABLE_SESSION_AFFINITY 1
#define ENABLE_SRC_RANGE_CHECK 1
#define ENCRYPT_MAP cilium_encrypt_state
#define ENDPOINTS_MAP cilium_lxc
#define ENDPOINTS_MAP_SIZE 65535
#define EP_POLICY_MAP cilium_ep_to_policy
#define EVENTS_MAP cilium_events
#define HASH_INIT4_SEED 0
#define HASH_INIT6_SEED 0
#define HEALTH_ID 4
#define HOST_ID 1
#define INIT_ID 5
#define IPCACHE_MAP cilium_ipcache
#define IPCACHE_MAP_SIZE 512000
#define IPV4_DIRECT_ROUTING 55224512
#define IPV4_FRAG_DATAGRAMS_MAP cilium_ipv4_frag_datagrams
#define IPV4_GATEWAY 0x6f00000a
#define IPV4_LOOPBACK 0x12afea9
#define IPV4_MASK 0xffffff
#define IPV4_RSS_PREFIX IPV4_DIRECT_ROUTING
#define IPV4_RSS_PREFIX_BITS 32
#define IS_L3_DEV(ifindex) false
#define KERNEL_HZ 250
#define LB4_AFFINITY_MAP cilium_lb4_affinity
#define LB4_BACKEND_MAP cilium_lb4_backends
#define LB4_REVERSE_NAT_MAP cilium_lb4_reverse_nat
#define LB4_REVERSE_NAT_SK_MAP cilium_lb4_reverse_sk
#define LB4_REVERSE_NAT_SK_MAP_SIZE 262144
#define LB4_SERVICES_MAP_V2 cilium_lb4_services_v2
#define LB4_SRC_RANGE_MAP cilium_lb4_source_range
#define LB4_SRC_RANGE_MAP_SIZE 65536
#define LB6_BACKEND_MAP cilium_lb6_backends
#define LB6_REVERSE_NAT_MAP cilium_lb6_reverse_nat
#define LB6_REVERSE_NAT_SK_MAP cilium_lb6_reverse_sk
#define LB6_REVERSE_NAT_SK_MAP_SIZE 262144
#define LB6_SERVICES_MAP_V2 cilium_lb6_services_v2
#define LB_AFFINITY_MATCH_MAP cilium_lb_affinity_match
#define LB_SELECTION 1
#define LB_SELECTION_MAGLEV 2
#define LB_SELECTION_RANDOM 1
#define LOCAL_NODE_ID 6
#define METRICS_MAP cilium_metrics
#define METRICS_MAP_SIZE 1024
#define MTU 1500
#define NATIVE_DEV_MAC_BY_IFINDEX(IFINDEX) ({ \
union macaddr __mac = {.addr = {0x0, 0x0, 0x0, 0x0, 0x0, 0x0}}; \
switch (IFINDEX) { \
 case 2: {union macaddr __tmp = {.addr = {0x0,0xc,0x29,0x7a,0xbe,0xf6}}; __mac=__tmp;} break; \
} \
__mac; })
#define NODEPORT_NEIGH4 cilium_nodeport_neigh4
#define NODEPORT_NEIGH4_SIZE 524288
#define NODEPORT_PORT_MAX 32767
#define NODEPORT_PORT_MAX_NAT 65535
#define NODEPORT_PORT_MIN 30000
#define NODEPORT_PORT_MIN_NAT 32768
#define NO_REDIRECT 1
#define POLICY_CALL_MAP cilium_call_policy
#define POLICY_MAP_SIZE 16384
#define POLICY_PROG_MAP_SIZE 65535
#define PREALLOCATE_MAPS 1
#define REMOTE_NODE_ID 6
#define SIGNAL_MAP cilium_signals
#define SNAT_MAPPING_IPV4 cilium_snat_v4_external
#define SNAT_MAPPING_IPV4_SIZE 524288
#define SOCKOPS_MAP_SIZE 65535
#define TRACE_PAYLOAD_LEN 128ULL
#define TUNNEL_ENDPOINT_MAP_SIZE 65536
#define TUNNEL_MAP cilium_tunnel_map
#define UNMANAGED_ID 3
#define WORLD_ID 2

// JSON_OUTPUT: eyJBTExPV19JQ01QX0ZSQUdfTkVFREVEIjoiMSIsIkNJTElVTV9JUFY0X0ZSQUdfTUFQX01BWF9FTlRSSUVTIjoiODE5MiIsIkNJTElVTV9MQl9NQVBfTUFYX0VOVFJJRVMiOiI2NTUzNiIsIkNUX0NMT1NFX1RJTUVPVVQiOiIxMCIsIkNUX0NPTk5FQ1RJT05fTElGRVRJTUVfTk9OVENQIjoiNjAiLCJDVF9DT05ORUNUSU9OX0xJRkVUSU1FX1RDUCI6IjIxNjAwIiwiQ1RfUkVQT1JUX0ZMQUdTIjoiMHgwMDA3IiwiQ1RfUkVQT1JUX0lOVEVSVkFMIjoiNSIsIkNUX1NFUlZJQ0VfTElGRVRJTUVfTk9OVENQIjoiNjAiLCJDVF9TRVJWSUNFX0xJRkVUSU1FX1RDUCI6IjIxNjAwIiwiQ1RfU1lOX1RJTUVPVVQiOiI2MCIsIkRJUkVDVF9ST1VUSU5HX0RFVl9JRklOREVYIjoiMiIsIkRTUl9FTkNBUF9JUElQIjoiMiIsIkRTUl9FTkNBUF9NT0RFIjoiMCIsIkRTUl9FTkNBUF9OT05FIjoiMSIsIkRTUl9YTEFURV9CQUNLRU5EIjoiMiIsIkRTUl9YTEFURV9GUk9OVEVORCI6IjEiLCJEU1JfWExBVEVfTU9ERSI6IjAiLCJFR1JFU1NfTUFQIjoiY2lsaXVtX2VncmVzc192NCIsIkVHUkVTU19NQVBfU0laRSI6IjE2Mzg0IiwiRU5BQkxFX0VYVEVSTkFMX0lQIjoiMSIsIkVOQUJMRV9GSUJfTE9PS1VQX0JZUEFTUyI6IjEiLCJFTkFCTEVfSE9TVFBPUlQiOiIxIiwiRU5BQkxFX0hPU1RfU0VSVklDRVNfRlVMTCI6IjEiLCJFTkFCTEVfSE9TVF9TRVJWSUNFU19QRUVSIjoiMSIsIkVOQUJMRV9IT1NUX1NFUlZJQ0VTX1RDUCI6IjEiLCJFTkFCTEVfSE9TVF9TRVJWSUNFU19VRFAiOiIxIiwiRU5BQkxFX0lERU5USVRZX01BUksiOiIxIiwiRU5BQkxFX0lQVjQiOiIxIiwiRU5BQkxFX0lQVjRfRlJBR01FTlRTIjoiMSIsIkVOQUJMRV9MT0FEQkFMQU5DRVIiOiIxIiwiRU5BQkxFX05PREVQT1JUIjoiMSIsIkVOQUJMRV9OT0RFUE9SVF9IQUlSUElOIjoiMSIsIkVOQUJMRV9TRVNTSU9OX0FGRklOSVRZIjoiMSIsIkVOQUJMRV9TUkNfUkFOR0VfQ0hFQ0siOiIxIiwiRU5DUllQVF9NQVAiOiJjaWxpdW1fZW5jcnlwdF9zdGF0ZSIsIkVORFBPSU5UU19NQVAiOiJjaWxpdW1fbHhjIiwiRU5EUE9JTlRTX01BUF9TSVpFIjoiNjU1MzUiLCJFUF9QT0xJQ1lfTUFQIjoiY2lsaXVtX2VwX3RvX3BvbGljeSIsIkVWRU5UU19NQVAiOiJjaWxpdW1fZXZlbnRzIiwiSEFTSF9JTklUNF9TRUVEIjoiMCIsIkhBU0hfSU5JVDZfU0VFRCI6IjAiLCJIRUFMVEhfSUQiOiI0IiwiSE9TVF9JRCI6IjEiLCJJTklUX0lEIjoiNSIsIklQQ0FDSEVfTUFQIjoiY2lsaXVtX2lwY2FjaGUiLCJJUENBQ0hFX01BUF9TSVpFIjoiNTEyMDAwIiwiSVBWNF9ESVJFQ1RfUk9VVElORyI6IjU1MjI0NTEyIiwiSVBWNF9GUkFHX0RBVEFHUkFNU19NQVAiOiJjaWxpdW1faXB2NF9mcmFnX2RhdGFncmFtcyIsIklQVjRfR0FURVdBWSI6IjB4NmYwMDAwMGEiLCJJUFY0X0xPT1BCQUNLIjoiMHgxMmFmZWE5IiwiSVBWNF9NQVNLIjoiMHhmZmZmZmYiLCJJUFY0X1JTU19QUkVGSVgiOiJJUFY0X0RJUkVDVF9ST1VUSU5HIiwiSVBWNF9SU1NfUFJFRklYX0JJVFMiOiIzMiIsIklTX0wzX0RFVihpZmluZGV4KSI6ImZhbHNlIiwiS0VSTkVMX0haIjoiMjUwIiwiTEI0X0FGRklOSVRZX01BUCI6ImNpbGl1bV9sYjRfYWZmaW5pdHkiLCJMQjRfQkFDS0VORF9NQVAiOiJjaWxpdW1fbGI0X2JhY2tlbmRzIiwiTEI0X1JFVkVSU0VfTkFUX01BUCI6ImNpbGl1bV9sYjRfcmV2ZXJzZV9uYXQiLCJMQjRfUkVWRVJTRV9OQVRfU0tfTUFQIjoiY2lsaXVtX2xiNF9yZXZlcnNlX3NrIiwiTEI0X1JFVkVSU0VfTkFUX1NLX01BUF9TSVpFIjoiMjYyMTQ0IiwiTEI0X1NFUlZJQ0VTX01BUF9WMiI6ImNpbGl1bV9sYjRfc2VydmljZXNfdjIiLCJMQjRfU1JDX1JBTkdFX01BUCI6ImNpbGl1bV9sYjRfc291cmNlX3JhbmdlIiwiTEI0X1NSQ19SQU5HRV9NQVBfU0laRSI6IjY1NTM2IiwiTEI2X0JBQ0tFTkRfTUFQIjoiY2lsaXVtX2xiNl9iYWNrZW5kcyIsIkxCNl9SRVZFUlNFX05BVF9NQVAiOiJjaWxpdW1fbGI2X3JldmVyc2VfbmF0IiwiTEI2X1JFVkVSU0VfTkFUX1NLX01BUCI6ImNpbGl1bV9sYjZfcmV2ZXJzZV9zayIsIkxCNl9SRVZFUlNFX05BVF9TS19NQVBfU0laRSI6IjI2MjE0NCIsIkxCNl9TRVJWSUNFU19NQVBfVjIiOiJjaWxpdW1fbGI2X3NlcnZpY2VzX3YyIiwiTEJfQUZGSU5JVFlfTUFUQ0hfTUFQIjoiY2lsaXVtX2xiX2FmZmluaXR5X21hdGNoIiwiTEJfU0VMRUNUSU9OIjoiMSIsIkxCX1NFTEVDVElPTl9NQUdMRVYiOiIyIiwiTEJfU0VMRUNUSU9OX1JBTkRPTSI6IjEiLCJMT0NBTF9OT0RFX0lEIjoiNiIsIk1FVFJJQ1NfTUFQIjoiY2lsaXVtX21ldHJpY3MiLCJNRVRSSUNTX01BUF9TSVpFIjoiMTAyNCIsIk1UVSI6IjE1MDAiLCJOQVRJVkVfREVWX01BQ19CWV9JRklOREVYKElGSU5ERVgpIjoiKHsgXFxcbnVuaW9uIG1hY2FkZHIgX19tYWMgPSB7LmFkZHIgPSB7MHgwLCAweDAsIDB4MCwgMHgwLCAweDAsIDB4MH19OyBcXFxuc3dpdGNoIChJRklOREVYKSB7IFxcXG4gY2FzZSAyOiB7dW5pb24gbWFjYWRkciBfX3RtcCA9IHsuYWRkciA9IHsweDAsMHhjLDB4MjksMHg3YSwweGJlLDB4ZjZ9fTsgX19tYWM9X190bXA7fSBicmVhazsgXFxcbn0gXFxcbl9fbWFjOyB9KSIsIk5PREVQT1JUX05FSUdINCI6ImNpbGl1bV9ub2RlcG9ydF9uZWlnaDQiLCJOT0RFUE9SVF9ORUlHSDRfU0laRSI6IjUyNDI4OCIsIk5PREVQT1JUX1BPUlRfTUFYIjoiMzI3NjciLCJOT0RFUE9SVF9QT1JUX01BWF9OQVQiOiI2NTUzNSIsIk5PREVQT1JUX1BPUlRfTUlOIjoiMzAwMDAiLCJOT0RFUE9SVF9QT1JUX01JTl9OQVQiOiIzMjc2OCIsIk5PX1JFRElSRUNUIjoiMSIsIlBPTElDWV9DQUxMX01BUCI6ImNpbGl1bV9jYWxsX3BvbGljeSIsIlBPTElDWV9NQVBfU0laRSI6IjE2Mzg0IiwiUE9MSUNZX1BST0dfTUFQX1NJWkUiOiI2NTUzNSIsIlBSRUFMTE9DQVRFX01BUFMiOiIxIiwiUkVNT1RFX05PREVfSUQiOiI2IiwiU0lHTkFMX01BUCI6ImNpbGl1bV9zaWduYWxzIiwiU05BVF9NQVBQSU5HX0lQVjQiOiJjaWxpdW1fc25hdF92NF9leHRlcm5hbCIsIlNOQVRfTUFQUElOR19JUFY0X1NJWkUiOiI1MjQyODgiLCJTT0NLT1BTX01BUF9TSVpFIjoiNjU1MzUiLCJUUkFDRV9QQVlMT0FEX0xFTiI6IjEyOFVMTCIsIlRVTk5FTF9FTkRQT0lOVF9NQVBfU0laRSI6IjY1NTM2IiwiVFVOTkVMX01BUCI6ImNpbGl1bV90dW5uZWxfbWFwIiwiVU5NQU5BR0VEX0lEIjoiMyIsIldPUkxEX0lEIjoiMiJ9
#ifndef CILIUM_NET_MAC
#define CILIUM_NET_MAC { .addr = {0xe6,0x5e,0xf7,0x29,0xe6,0xb8}}
#endif /* CILIUM_NET_MAC */
#define HOST_IFINDEX 6
#define HOST_IFINDEX_MAC { .addr = {0xe6,0xd1,0x5c,0x79,0x4e,0x64}}
#define CILIUM_IFINDEX 7
#define EPHEMERAL_MIN 32768
#define ENCAP_IFINDEX 8
